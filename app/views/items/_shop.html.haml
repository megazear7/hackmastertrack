.row
  .col-md-6
    = form_tag items_path, :method => 'get' do
      .row
        .col-md-8
          = select_tag :view, options_for_select(item_views, params[:view]), class: "string form-control search-box-align form-border"
        .col-md-4
          = submit_tag "Search", :name => nil, class: "btn btn-default search-button-align search-btn"
          = link_to "Reset", items_path, class: "btn btn-default"
  .col-md-6
    = link_to 'New Item', new_item_path, class: "btn btn-primary pull-right" if current_user.admin_level >= 1
%br
- item_groups(params[:view]).each do |item_group|
  %h4= item_group.titleize
  .accordion{ "id"=>"accordion"+item_group }
    %table.table.table-hover.table-responsive
      %thead
        %tr
          %th Name
          - item_stats(params[:view]).each do |header, stat_method|
            %th= header
          - if current_user.admin_level >= 1
            %th
            %th
      %tbody
        - items.where(item_type: item_group).order(:name).each_with_index do |item, index|
          %tr{ "id"=>"collapse_"+item_group+"_"+index.to_s+"_travel" }
            %td
              .accordion-group
                .accordion-heading
                  %a.accordion-toggle{ "data-toggle"=>"collapse", "data-parent"=>"#accordion"+item_group, "href"=>"#collapse_"+item_group+"_"+index.to_s }
                    = item.name
                .accordion-body.collapse{ "id"=>"collapse_"+item_group+"_"+index.to_s }
                  .accordion-inner
                    - if shop_for_character
                      = render partial: "items/shop_for_character_form", locals: { character: character, view_details: view_details, buy_item: buy_item, take_item: take_item, item_group: item_group, index: index, item: item }
                    - else
                      = render partial: "items/shop_form", locals: { view_details: view_details, buy_item: buy_item, take_item: take_item, item_group: item_group, index: index, item: item }
            - item_stats(params[:view]).each do |header, stat_method|
              %td= item.send(stat_method)
            - if current_user.admin_level >= 1
              %td= link_to raw('<span class="octicon octicon-pencil"></span>'), edit_item_path(item)
              %td= link_to raw('<span class="octicon octicon-trashcan"></span>'), item, :method => :delete, :data => { :confirm => 'Are you sure?' }
